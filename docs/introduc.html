<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Análise de Dados Amostrais Complexos</title>
  <meta name="description" content="Análise de dados de pesquisas amostrais complexas.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Análise de Dados Amostrais Complexos" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="Figuras/capa.png" />
  <meta property="og:description" content="Análise de dados de pesquisas amostrais complexas." />
  <meta name="github-repo" content="djalmapessoa/adac" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Análise de Dados Amostrais Complexos" />
  
  <meta name="twitter:description" content="Análise de dados de pesquisas amostrais complexas." />
  <meta name="twitter:image" content="Figuras/capa.png" />

<meta name="author" content="Djalma Pessoa e Pedro Nascimento Silva">


<meta name="date" content="2017-09-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="refinf.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#agradecimentos"><i class="fa fa-check"></i>Agradecimentos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduc.html"><a href="introduc.html"><i class="fa fa-check"></i><b>1</b> Introdução</a><ul>
<li class="chapter" data-level="1.1" data-path="introduc.html"><a href="introduc.html#motivacao"><i class="fa fa-check"></i><b>1.1</b> Motivação</a></li>
<li class="chapter" data-level="1.2" data-path="introduc.html"><a href="introduc.html#objetivos-do-livro"><i class="fa fa-check"></i><b>1.2</b> Objetivos do Livro</a></li>
<li class="chapter" data-level="1.3" data-path="introduc.html"><a href="introduc.html#epa"><i class="fa fa-check"></i><b>1.3</b> Laboratório de R do Capítulo 1.</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduc.html"><a href="introduc.html#estimativa-do-efeito-de-plano-amostral-epa"><i class="fa fa-check"></i><b>1.3.1</b> Estimativa do efeito de plano amostral (EPA)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="refinf.html"><a href="refinf.html"><i class="fa fa-check"></i><b>2</b> Referencial para Inferência</a><ul>
<li class="chapter" data-level="2.1" data-path="refinf.html"><a href="refinf.html#classic"><i class="fa fa-check"></i><b>2.1</b> Modelagem - Primeiras Idéias</a><ul>
<li class="chapter" data-level="2.1.1" data-path="refinf.html"><a href="refinf.html#abordagem-1---modelagem-classica"><i class="fa fa-check"></i><b>2.1.1</b> Abordagem 1 - Modelagem Clássica</a></li>
<li class="chapter" data-level="2.1.2" data-path="refinf.html"><a href="refinf.html#abordagem-2---amostragem-probabilistica"><i class="fa fa-check"></i><b>2.1.2</b> Abordagem 2 - Amostragem Probabilística</a></li>
<li class="chapter" data-level="2.1.3" data-path="refinf.html"><a href="refinf.html#discussao-das-abordagens-1-e-2"><i class="fa fa-check"></i><b>2.1.3</b> Discussão das Abordagens 1 e 2</a></li>
<li class="chapter" data-level="2.1.4" data-path="refinf.html"><a href="refinf.html#modelsuperpop"><i class="fa fa-check"></i><b>2.1.4</b> Abordagem 3 - Modelagem de Superpopulação</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="refinf.html"><a href="refinf.html#fontes-de-variacao"><i class="fa fa-check"></i><b>2.2</b> Fontes de Variação</a></li>
<li class="chapter" data-level="2.3" data-path="refinf.html"><a href="refinf.html#modelos-de-superpopulacao"><i class="fa fa-check"></i><b>2.3</b> Modelos de Superpopulação</a></li>
<li class="chapter" data-level="2.4" data-path="refinf.html"><a href="refinf.html#planamo"><i class="fa fa-check"></i><b>2.4</b> Planejamento Amostral</a></li>
<li class="chapter" data-level="2.5" data-path="refinf.html"><a href="refinf.html#inform"><i class="fa fa-check"></i><b>2.5</b> Planos Amostrais Informativos e Ignoráveis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="capplanamo.html"><a href="capplanamo.html"><i class="fa fa-check"></i><b>3</b> Estimação Baseada no Plano Amostral</a><ul>
<li class="chapter" data-level="3.1" data-path="capplanamo.html"><a href="capplanamo.html#estimatotais"><i class="fa fa-check"></i><b>3.1</b> Estimação de Totais</a></li>
<li class="chapter" data-level="3.2" data-path="capplanamo.html"><a href="capplanamo.html#por-que-estimar-variancias"><i class="fa fa-check"></i><b>3.2</b> Por que Estimar Variâncias</a></li>
<li class="chapter" data-level="3.3" data-path="capplanamo.html"><a href="capplanamo.html#taylor"><i class="fa fa-check"></i><b>3.3</b> Linearização de Taylor para Estimar variâncias</a></li>
<li class="chapter" data-level="3.4" data-path="capplanamo.html"><a href="capplanamo.html#metodo-do-conglomerado-primario"><i class="fa fa-check"></i><b>3.4</b> Método do Conglomerado Primário</a></li>
<li class="chapter" data-level="3.5" data-path="capplanamo.html"><a href="capplanamo.html#metodos-de-replicacao"><i class="fa fa-check"></i><b>3.5</b> Métodos de Replicação</a></li>
<li class="chapter" data-level="3.6" data-path="capplanamo.html"><a href="capplanamo.html#laboratorio-de-r"><i class="fa fa-check"></i><b>3.6</b> Laboratório de R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduc.html"><a href="introduc.html#epa"><i class="fa fa-check"></i><b>4</b> Efeitos do Plano Amostral</a><ul>
<li class="chapter" data-level="4.1" data-path="epa.html"><a href="epa.html"><i class="fa fa-check"></i><b>4.1</b> Introdução</a></li>
<li class="chapter" data-level="4.2" data-path="epa.html"><a href="epa.html#efeito-do-plano-amostral-epa-de-kish"><i class="fa fa-check"></i><b>4.2</b> Efeito do Plano Amostral (EPA) de Kish</a></li>
<li class="chapter" data-level="4.3" data-path="epa.html"><a href="epa.html#efeito-do-plano-amostral-ampliado"><i class="fa fa-check"></i><b>4.3</b> Efeito do Plano Amostral Ampliado</a></li>
<li class="chapter" data-level="4.4" data-path="epa.html"><a href="epa.html#intervalos-de-confianca-e-testes-de-hipoteses"><i class="fa fa-check"></i><b>4.4</b> Intervalos de Confiança e Testes de Hipóteses</a></li>
<li class="chapter" data-level="4.5" data-path="epa.html"><a href="epa.html#efeitos-multivariados-de-plano-amostral"><i class="fa fa-check"></i><b>4.5</b> Efeitos Multivariados de Plano Amostral</a></li>
<li class="chapter" data-level="4.6" data-path="epa.html"><a href="epa.html#laboratorio-de-r-1"><i class="fa fa-check"></i><b>4.6</b> Laboratório de R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ajmodpar.html"><a href="ajmodpar.html"><i class="fa fa-check"></i><b>5</b> Ajuste de Modelos Paramétricos</a><ul>
<li class="chapter" data-level="5.1" data-path="ajmodpar.html"><a href="ajmodpar.html#modpar1"><i class="fa fa-check"></i><b>5.1</b> Introdução</a></li>
<li class="chapter" data-level="5.2" data-path="ajmodpar.html"><a href="ajmodpar.html#metodo-de-maxima-verossimilhanca-mv"><i class="fa fa-check"></i><b>5.2</b> Método de Máxima Verossimilhança (MV)</a></li>
<li class="chapter" data-level="5.3" data-path="ajmodpar.html"><a href="ajmodpar.html#ponderacao-de-dados-amostrais"><i class="fa fa-check"></i><b>5.3</b> Ponderação de Dados Amostrais</a></li>
<li class="chapter" data-level="5.4" data-path="ajmodpar.html"><a href="ajmodpar.html#modpar3"><i class="fa fa-check"></i><b>5.4</b> Método de Máxima Pseudo-Verossimilhança</a></li>
<li class="chapter" data-level="5.5" data-path="ajmodpar.html"><a href="ajmodpar.html#robustez-do-procedimento-mpv"><i class="fa fa-check"></i><b>5.5</b> Robustez do Procedimento MPV</a></li>
<li class="chapter" data-level="5.6" data-path="ajmodpar.html"><a href="ajmodpar.html#desvantagens-da-inferencia-de-aleatorizacao"><i class="fa fa-check"></i><b>5.6</b> Desvantagens da Inferência de Aleatorização</a></li>
<li class="chapter" data-level="5.7" data-path="ajmodpar.html"><a href="ajmodpar.html#laboratorio-de-r-2"><i class="fa fa-check"></i><b>5.7</b> Laboratório de R</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modreg.html"><a href="modreg.html"><i class="fa fa-check"></i><b>6</b> Modelos de Regressão</a><ul>
<li class="chapter" data-level="6.1" data-path="modreg.html"><a href="modreg.html#modlinear"><i class="fa fa-check"></i><b>6.1</b> Modelo de Regressão Linear Normal</a><ul>
<li class="chapter" data-level="6.1.1" data-path="modreg.html"><a href="modreg.html#especificacao-do-modelo"><i class="fa fa-check"></i><b>6.1.1</b> Especificação do Modelo</a></li>
<li class="chapter" data-level="6.1.2" data-path="modreg.html"><a href="modreg.html#pseudo-parametros-do-modelo"><i class="fa fa-check"></i><b>6.1.2</b> Pseudo-parâmetros do Modelo</a></li>
<li class="chapter" data-level="6.1.3" data-path="modreg.html"><a href="modreg.html#estimadores-de-mpv-dos-parametros-do-modelo"><i class="fa fa-check"></i><b>6.1.3</b> Estimadores de MPV dos Parâmetros do Modelo</a></li>
<li class="chapter" data-level="6.1.4" data-path="modreg.html"><a href="modreg.html#estimacao-da-variancia-de-estimadores-de-mpv"><i class="fa fa-check"></i><b>6.1.4</b> Estimação da Variância de Estimadores de MPV</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modreg.html"><a href="modreg.html#modlogist"><i class="fa fa-check"></i><b>6.2</b> Modelo de Regressão Logística</a></li>
<li class="chapter" data-level="6.3" data-path="modreg.html"><a href="modreg.html#teste-de-hipoteses"><i class="fa fa-check"></i><b>6.3</b> Teste de Hipóteses</a></li>
<li class="chapter" data-level="6.4" data-path="modreg.html"><a href="modreg.html#laboratorio-de-r-3"><i class="fa fa-check"></i><b>6.4</b> Laboratório de R</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="testqualajust.html"><a href="testqualajust.html"><i class="fa fa-check"></i><b>7</b> Testes de Qualidade de Ajuste</a><ul>
<li class="chapter" data-level="7.1" data-path="testqualajust.html"><a href="testqualajust.html#introducao-1"><i class="fa fa-check"></i><b>7.1</b> Introdução</a></li>
<li class="chapter" data-level="7.2" data-path="testqualajust.html"><a href="testqualajust.html#teste-para-uma-proporcao"><i class="fa fa-check"></i><b>7.2</b> Teste para uma Proporção</a><ul>
<li class="chapter" data-level="7.2.1" data-path="testqualajust.html"><a href="testqualajust.html#correcao-de-estatisticas-classicas"><i class="fa fa-check"></i><b>7.2.1</b> Correção de Estatísticas Clássicas</a></li>
<li class="chapter" data-level="7.2.2" data-path="testqualajust.html"><a href="testqualajust.html#estatistica-de-wald"><i class="fa fa-check"></i><b>7.2.2</b> Estatística de Wald</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="testqualajust.html"><a href="testqualajust.html#teste-para-varias-proporcoes"><i class="fa fa-check"></i><b>7.3</b> Teste para Várias Proporções</a><ul>
<li class="chapter" data-level="7.3.1" data-path="testqualajust.html"><a href="testqualajust.html#estatistica-de-wald-baseada-no-plano-amostral"><i class="fa fa-check"></i><b>7.3.1</b> Estatística de Wald Baseada no Plano Amostral</a></li>
<li class="chapter" data-level="7.3.2" data-path="testqualajust.html"><a href="testqualajust.html#situacoes-instaveis"><i class="fa fa-check"></i><b>7.3.2</b> Situações Instáveis</a></li>
<li class="chapter" data-level="7.3.3" data-path="testqualajust.html"><a href="testqualajust.html#raoscott"><i class="fa fa-check"></i><b>7.3.3</b> Estatística de Pearson com Ajuste de Rao-Scott</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="testqualajust.html"><a href="testqualajust.html#laboratorio-de-r-4"><i class="fa fa-check"></i><b>7.4</b> Laboratório de R</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="testetab2.html"><a href="testetab2.html"><i class="fa fa-check"></i><b>8</b> Testes em Tabelas de Duas Entradas</a><ul>
<li class="chapter" data-level="8.1" data-path="testetab2.html"><a href="testetab2.html#introducao-2"><i class="fa fa-check"></i><b>8.1</b> Introdução</a></li>
<li class="chapter" data-level="8.2" data-path="testetab2.html"><a href="testetab2.html#tabelas22"><i class="fa fa-check"></i><b>8.2</b> Tabelas 2x2</a><ul>
<li class="chapter" data-level="8.2.1" data-path="testetab2.html"><a href="testetab2.html#teste-de-independencia"><i class="fa fa-check"></i><b>8.2.1</b> Teste de Independência</a></li>
<li class="chapter" data-level="8.2.2" data-path="testetab2.html"><a href="testetab2.html#teste-de-homogeneidade"><i class="fa fa-check"></i><b>8.2.2</b> Teste de Homogeneidade</a></li>
<li class="chapter" data-level="8.2.3" data-path="testetab2.html"><a href="testetab2.html#efeitos-de-plano-amostral-nas-celas"><i class="fa fa-check"></i><b>8.2.3</b> Efeitos de Plano Amostral nas Celas</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="testetab2.html"><a href="testetab2.html#tabelas-de-duas-entradas-caso-geral"><i class="fa fa-check"></i><b>8.3</b> Tabelas de Duas Entradas (Caso Geral)</a><ul>
<li class="chapter" data-level="8.3.1" data-path="testetab2.html"><a href="testetab2.html#teste-de-homogeneidade-1"><i class="fa fa-check"></i><b>8.3.1</b> Teste de Homogeneidade</a></li>
<li class="chapter" data-level="8.3.2" data-path="testetab2.html"><a href="testetab2.html#teste-de-independencia-1"><i class="fa fa-check"></i><b>8.3.2</b> Teste de Independência</a></li>
<li class="chapter" data-level="8.3.3" data-path="testetab2.html"><a href="testetab2.html#estatistica-de-wald-baseada-no-plano-amostral-1"><i class="fa fa-check"></i><b>8.3.3</b> Estatística de Wald Baseada no Plano Amostral</a></li>
<li class="chapter" data-level="8.3.4" data-path="testetab2.html"><a href="testetab2.html#estatistica-de-pearson-com-ajuste-de-rao-scott"><i class="fa fa-check"></i><b>8.3.4</b> Estatística de Pearson com Ajuste de Rao-Scott</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="testetab2.html"><a href="testetab2.html#laboratorio-de-r-5"><i class="fa fa-check"></i><b>8.4</b> Laboratório de R</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="estimacao-de-densidades.html"><a href="estimacao-de-densidades.html"><i class="fa fa-check"></i><b>9</b> Estimação de densidades</a><ul>
<li class="chapter" data-level="9.1" data-path="estimacao-de-densidades.html"><a href="estimacao-de-densidades.html#introducao-3"><i class="fa fa-check"></i><b>9.1</b> Introdução</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modelos-hierarquicos.html"><a href="modelos-hierarquicos.html"><i class="fa fa-check"></i><b>10</b> Modelos Hierárquicos</a><ul>
<li class="chapter" data-level="10.1" data-path="modelos-hierarquicos.html"><a href="modelos-hierarquicos.html#introducao-4"><i class="fa fa-check"></i><b>10.1</b> Introdução</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="nao-resposta.html"><a href="nao-resposta.html"><i class="fa fa-check"></i><b>11</b> Não-Resposta</a><ul>
<li class="chapter" data-level="11.1" data-path="nao-resposta.html"><a href="nao-resposta.html#introducao-5"><i class="fa fa-check"></i><b>11.1</b> Introdução</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="diagnostico-de-ajuste-de-modelo.html"><a href="diagnostico-de-ajuste-de-modelo.html"><i class="fa fa-check"></i><b>12</b> Diagnóstico de ajuste de modelo</a><ul>
<li class="chapter" data-level="12.1" data-path="diagnostico-de-ajuste-de-modelo.html"><a href="diagnostico-de-ajuste-de-modelo.html#introducao-6"><i class="fa fa-check"></i><b>12.1</b> Introdução</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="agregdesag.html"><a href="agregdesag.html"><i class="fa fa-check"></i><b>13</b> Agregação vs. Desagregação</a><ul>
<li class="chapter" data-level="13.1" data-path="agregdesag.html"><a href="agregdesag.html#introducao-7"><i class="fa fa-check"></i><b>13.1</b> Introdução</a></li>
<li class="chapter" data-level="13.2" data-path="agregdesag.html"><a href="agregdesag.html#modelagem-da-estrutura-populacional"><i class="fa fa-check"></i><b>13.2</b> Modelagem da Estrutura Populacional</a></li>
<li class="chapter" data-level="13.3" data-path="agregdesag.html"><a href="agregdesag.html#modelos-hierarquicos-1"><i class="fa fa-check"></i><b>13.3</b> Modelos Hierárquicos</a></li>
<li class="chapter" data-level="13.4" data-path="agregdesag.html"><a href="agregdesag.html#analise-desagregada-pros-e-contras"><i class="fa fa-check"></i><b>13.4</b> Análise Desagregada: Prós e Contras</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="pacotes.html"><a href="pacotes.html"><i class="fa fa-check"></i><b>14</b> Pacotes para Analisar Dados Amostrais</a><ul>
<li class="chapter" data-level="14.1" data-path="pacotes.html"><a href="pacotes.html#introducao-8"><i class="fa fa-check"></i><b>14.1</b> Introdução</a></li>
<li class="chapter" data-level="14.2" data-path="pacotes.html"><a href="pacotes.html#pacotes-computacionais"><i class="fa fa-check"></i><b>14.2</b> Pacotes Computacionais</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referências</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análise de Dados Amostrais Complexos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduc" class="section level1">
<h1><span class="header-section-number">Capítulo 1</span> Introdução</h1>
<div id="motivacao" class="section level2">
<h2><span class="header-section-number">1.1</span> Motivação</h2>
<p>Este livro trata de problema de grande importância para os usuários de dados obtidos através de pesquisas amostrais por agências produtoras de informações estatísticas. Tais dados são comumente utilizados em análises descritivas envolvendo o cálculo de estimativas para totais, proporções, médias e razões, nas quais, em geral, são devidamente considerados os pesos distintos das observações e o planejamento da amostra que lhes deu origem.</p>
<p>Outro uso destes dados, denominado secundário, é a construção e ajuste de modelos, feita geralmente por analistas que trabalham fora das agências produtoras dos dados. Neste caso, o foco é, essencialmente, estabelecer a natureza de relações ou associações entre variáveis. Para isto, a estatística clássica conta com um arsenal de ferramentas de análise, já incorporado aos principais pacotes estatísticos disponíveis. O uso destes pacotes se faz, entretanto, sob condições que não refletem a complexidade usualmente envolvida nas pesquisas amostrais de populações finitas. Em geral, partem de hipóteses básicas que só são válidas quando os dados são obtidos através de amostras aleatórias simples com reposição (AASC). Tais pacotes estatísticos não consideram os seguintes aspectos relevantes no caso de amostras complexas:</p>
<p>i.) <strong>probabilidades distintas de seleção das unidades</strong>;</p>
<p>ii.) <strong>conglomeração das unidades</strong>;</p>
<p>iii.) <strong>estratificação</strong>;</p>
<p>iv.) <strong>calibração ou imputação para não-resposta e outros ajustes</strong>.</p>
<p>As estimativas pontuais de parâmetros da população ou de modelos são influenciadas por pesos distintos das observações. Além disso, as estimativas de variância (ou da precisão dos estimadores) são influenciadas pela conglomeração, estratificação e pesos, ou no caso de não resposta, também por eventual imputação de dados faltantes. Ao ignorar estes aspectos, os pacotes tradicionais de análise podem produzir estimativas incorretas das variâncias das estimativas pontuais.</p>
<p>A seguir vamos apresentar um exemplo de uso de dados de uma pesquisa amostral real para ilustrar como os pontos i) a iv) acima mencionados afetam a inferência sobre quantidades descritivas populacionais tais como médias, proporções, razões e totais.</p>

<div class="example">
<span id="exm:distppv" class="example"><strong>Exemplo 1.1  </strong></span>Distribuição dos pesos da amostra da PPV
</div>

<p>Os dados deste exemplo são relativos à distribuição dos pesos na amostra da Pesquisa sobre Padrões de Vida (PPV), realizada pelo IBGE nos anos 1996-97. <span class="citation">(Albieri and Bianchini <a href="#ref-albieri">1997</a>)</span> descrevem resumidamente a Pesquisa sobre Padrões de Vida (PPV), que foi realizada nas Regiões Nordeste e Sudeste do País, considerando 10 estratos geográficos, a saber: Região Metropolitana de Fortaleza, Região Metropolitana de Recife, Região Metropolitana de Salvador, restante da área urbana do Nordeste, restante da área rural do Nordeste, Região Metropolitana de Belo Horizonte, Região Metropolitana do Rio de Janeiro, Região Metropolitana de São Paulo, restante da área urbana do Sudeste e restante da área rural do Sudeste.</p>
<p>O plano amostral empregado na seleção da amostra da PPV foi de dois estágios, com estratificação das unidades primárias de amostragem (no caso os setores censitários da base geográfica do IBGE conforme usada para o Censo Demográfico de 1991), seleção destes setores com probabilidade proporcional ao tamanho, e seleção aleatória das unidades de segundo estágio (domicílios). O tamanho da amostra para cada estrato geográfico foi fixado em 480 domicílios, e o número de setores selecionados foi fixado em 60, com 8 domicílios selecionados em cada setor. A exceção ficou por conta dos estratos que correspondem ao restante da área rural de cada Região, onde foram selecionados 30 setores e 16 domicílios por setor, em função da dificuldade de acesso a esses setores, o que implicaria em aumento de custo da coleta.</p>
<p>Os setores de cada um dos 10 estratos geográficos foram subdivididos em 3 estratos de acordo com a renda média mensal do chefe do domicílio por setor, perfazendo um total de 30 estratos geográficos versus renda. Em seguida foi feita uma alocação proporcional, com base no número de domicílios particulares permanentes ocupados do estrato de renda no universo de cada estrato geográfico, obtidos pelo Censo de 1991. No final foram obtidos 554 setores na amostra, distribuídos tal como revela a Tabela <a href="introduc.html#tab:numset">1.1</a>.</p>
<table>
<caption><span id="tab:numset">Tabela 1.1: </span>Número de setores na população e na amostra, por estrato geográfico</caption>
<thead>
<tr class="header">
<th align="left">Estrato</th>
<th align="center">População</th>
<th align="center">Amostra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RM Fortaleza</td>
<td align="center">2263</td>
<td align="center">62</td>
</tr>
<tr class="even">
<td align="left">RM Recife</td>
<td align="center">2309</td>
<td align="center">61</td>
</tr>
<tr class="odd">
<td align="left">RM Salvador</td>
<td align="center">2186</td>
<td align="center">61</td>
</tr>
<tr class="even">
<td align="left">Restante Nordeste Urbano</td>
<td align="center">15057</td>
<td align="center">61</td>
</tr>
<tr class="odd">
<td align="left">Restante Nordeste Rural</td>
<td align="center">23711</td>
<td align="center">33</td>
</tr>
<tr class="even">
<td align="left">RM Belo Horizonte</td>
<td align="center">3283</td>
<td align="center">62</td>
</tr>
<tr class="odd">
<td align="left">RM Rio de Janeiro</td>
<td align="center">10420</td>
<td align="center">61</td>
</tr>
<tr class="even">
<td align="left">RM São Paulo</td>
<td align="center">14931</td>
<td align="center">61</td>
</tr>
<tr class="odd">
<td align="left">Restante Sudeste Urbano</td>
<td align="center">25855</td>
<td align="center">61</td>
</tr>
<tr class="even">
<td align="left">Restante Sudeste Rural</td>
<td align="center">12001</td>
<td align="center">31</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="center">112016</td>
<td align="center">554</td>
</tr>
</tbody>
</table>
<p>A Tabela <a href="introduc.html#tab:dispesos">1.2</a> apresenta um resumo das distribuições dos pesos amostrais para as Regiões Nordeste (5 estratos geográficos) e Sudeste (5 estratos geográficos) separadamente e para o conjunto da amostra da PPV.</p>
<table>
<caption><span id="tab:dispesos">Tabela 1.2: </span>Distribuição dos pesos da amostra da PPV</caption>
<thead>
<tr class="header">
<th align="left">Região</th>
<th align="center">Mínimo</th>
<th align="center">Q1</th>
<th align="center">Mediana</th>
<th align="center">Q3</th>
<th align="center">Máximo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Nordeste</td>
<td align="center">724</td>
<td align="center">1194</td>
<td align="center">1556</td>
<td align="center">6937</td>
<td align="center">15348</td>
</tr>
<tr class="even">
<td align="left">Sudeste</td>
<td align="center">991</td>
<td align="center">2789</td>
<td align="center">5429</td>
<td align="center">9509</td>
<td align="center">29234</td>
</tr>
<tr class="odd">
<td align="left">Nordeste_Sudeste</td>
<td align="center">724</td>
<td align="center">1403</td>
<td align="center">3785</td>
<td align="center">8306</td>
<td align="center">29234</td>
</tr>
</tbody>
</table>
<p>No cálculo dos pesos foram consideradas as probabilidades de inclusão dos elementos na amostra bem como correções devido a não-resposta. Contudo, a grande variabilidade dos pesos amostrais da PPV é devida à variabilidade das probabilidades de inclusão na amostra, ilustrando desta forma o ponto i) citado anteriormente nesta seção.</p>
<p>Na análise de dados desta pesquisa, deve-se considerar que há elementos da amostra com pesos bem distintos. Por exemplo, a razão entre o maior e o menor peso é cerca de 40 vezes. Tais pesos são utilizados para <code>expandir</code> os dados, multiplicando-se cada observação pelo seu respectivo peso. Assim, por exemplo, para <code>estimar</code> quantos elementos <code>da população</code> pertencem a determinado conjunto (domínio), basta somar os pesos dos elementos da amostra que pertencem a este conjunto. É possível ainda incorporar os pesos, de maneira simples e natural, quando estimamos medidas descritivas simples da população tais como totais, médias, proporções, razões, etc.</p>
<p>Por outro lado, quando utilizamos a amostra para estudos analíticos, as opções padrão disponíveis nos pacotes estatísticos usuais para levar em conta os pesos distintos das observações são apropriadas somente para observações independentes e identicamente distribuídas (IID). Por exemplo, os procedimentos padrão disponíveis para estimar a média populacional permitem utilizar pesos distintos das observações amostrais, mas tratariam tais pesos como se fossem frequências de observações repetidas na amostra, e portanto interpretariam a soma dos pesos como tamanho amostral, situação que na maioria das vezes gera inferências incorretas sobre a precisão das estimativas, pois o tamanho da amostra é muito menor que a soma dos pesos amostrais usualmente encontrados nos arquivos de microdados de pesquisas disseminados por agências de estatísticas oficiais. Em tais pesquisas, a opção mais freqüente é disseminar pesos que somados estimam o total de unidades <code>da população</code>.</p>
<p>Além disso, a variabilidade dos pesos para distintas observações amostrais produz impactos tanto na estimação pontual quanto na estimação das variâncias dessas estimativas, que sofre ainda influência da conglomeração e estratificação - pontos ii) e iii) mencionados anteriormente.</p>
<p>Para exemplificar o impacto de ignorar os pesos e o plano amostral ao estimar quantidades descritivas populacionais, tais como totais, médias, proporções e razões, calculamos estimativas de quantidades desses diferentes tipos usando a amostra da PPV juntamente com estimativas das respectivas variâncias. Essas estimativas de variâncias foram calculadas sob duas estratégias: considerando amostragem aleatória simples (portanto ignorando o plano amostral efetivamente adotado), e considerando o plano amostral da pesquisa e os pesos diferenciados das unidades. A razão entre as estimativas de variância obtidas sob o plano amostral verdadeiro e sob amostragem aleatória simples foi calculada para cada uma das estimativas consideradas usando a library <code>survey</code> do R <span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span> . Essa razão fornece uma medida do efeito de ignorar o plano amostral . Os resultados das estimativas ponderadas e variâncias considerando o plano amostral são apresentados na Tabela <a href="introduc.html#tab:epas">1.3</a> , juntamente com as medidas dos efeitos de plano amostral (EPA). Exemplos de utilização da library <code>survey</code> para obtenção de estimativas apresentadas na <a href="introduc.html#tab:epas">1.3</a> estão na Seção <a href="introduc.html#epa">1.3</a>. As outras estimativas da Tabela <a href="introduc.html#tab:epas">1.3</a> podem ser obtidas de maneira análoga.</p>
<p>Na Tabela <a href="introduc.html#tab:epas">1.3</a> apresentamos as estimativas dos seguintes parâmetros populacionais:</p>
<ol style="list-style-type: decimal">
<li>Número médio de pessoas por domicílio;</li>
<li>% de domicílios alugados;</li>
<li>Número total de pessoas que avaliaram seu estado de de saúde como ruim;</li>
<li>Total de analfabetos de 7 a 14 anos;</li>
<li>Total de analfabetos de mais de 14 anos;</li>
<li>% de analfabetos de 7 a 14 anos;</li>
<li>% de analfabetos de mais de 14 anos;</li>
<li>Total de mulheres de 12 a 49 anos que tiveram filhos;</li>
<li>Total de mulheres de 12 a 49 anos que tiveram filhos vivos; 10.Total de mulheres de 12 a 49 anos que tiveram filhos mortos;</li>
<li>Número médio de filhos tidos por mulheres de 12 a 49 anos;</li>
<li>Razão de dependência.</li>
</ol>
<table>
<caption><span id="tab:epas">Tabela 1.3: </span>Estimativas de Efeitos de Plano Amostral (EPAs) para variáveis selecionadas da PPV - Região Sudeste</caption>
<thead>
<tr class="header">
<th align="left">Parâmetro</th>
<th align="right">Estimativa</th>
<th align="right">DP</th>
<th align="right">EPA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1.</td>
<td align="right">3.62</td>
<td align="right">0.05</td>
<td align="right">2.64</td>
</tr>
<tr class="even">
<td align="left">2.</td>
<td align="right">10.70</td>
<td align="right">1.15</td>
<td align="right">2.97</td>
</tr>
<tr class="odd">
<td align="left">3.</td>
<td align="right">1208123.00</td>
<td align="right">146681.00</td>
<td align="right">3.37</td>
</tr>
<tr class="even">
<td align="left">4.</td>
<td align="right">1174220.00</td>
<td align="right">127982.00</td>
<td align="right">2.64</td>
</tr>
<tr class="odd">
<td align="left">5.</td>
<td align="right">4792344.00</td>
<td align="right">318877.00</td>
<td align="right">4.17</td>
</tr>
<tr class="even">
<td align="left">6.</td>
<td align="right">11.87</td>
<td align="right">1.18</td>
<td align="right">2.46</td>
</tr>
<tr class="odd">
<td align="left">7.</td>
<td align="right">10.87</td>
<td align="right">0.67</td>
<td align="right">3.86</td>
</tr>
<tr class="even">
<td align="left">8.</td>
<td align="right">10817590.00</td>
<td align="right">322947.00</td>
<td align="right">2.02</td>
</tr>
<tr class="odd">
<td align="left">9.</td>
<td align="right">10804511.00</td>
<td align="right">323182.00</td>
<td align="right">3.02</td>
</tr>
<tr class="even">
<td align="left">10.</td>
<td align="right">709145.00</td>
<td align="right">87363.00</td>
<td align="right">2.03</td>
</tr>
<tr class="odd">
<td align="left">11.</td>
<td align="right">1.39</td>
<td align="right">0.03</td>
<td align="right">1.26</td>
</tr>
<tr class="even">
<td align="left">12.</td>
<td align="right">0.53</td>
<td align="right">0.01</td>
<td align="right">1.99</td>
</tr>
</tbody>
</table>
<p>Como se pode observar da quarta coluna da Tabela <a href="introduc.html#tab:epas">1.3</a>, os valores do efeito do plano amostral variam de um modesto 1,26 para o número médio de filhos tidos por mulheres em idade fértil (12 a 49 anos de idade) até um substancial 4,17 para o total de analfabetos entre pessoas de mais de 14 anos. Nesse último caso, usar a estimativa de variância como se o plano amostral fosse amostragem aleatória simples implicaria em subestimar consideravelmente a variância da estimativa pontual, que é mais que 4 vezes maior se consideramos o plano amostral efetivamente utilizado.</p>
<p>Note que as variáveis e parâmetros cujas estimativas são apresentadas na Tabela <a href="introduc.html#tab:epas">1.3</a> não foram escolhidas de forma a acentuar os efeitos ilustrados, mas tão somente para representar distintos parâmetros (médias, razões, totais, proporções) e variáveis de interesse. Os resultados apresentados para as estimativas de EPA ilustram bem o cenário típico em pesquisas amostrais complexas: o impacto do plano amostral sobre a inferência varia conforme a variável e o tipo de parâmetro de interesse. Note ainda que à exceção do menor valor, todas as demais estimativas de EPA apresentaram valores superiores a 2.</p>
</div>
<div id="objetivos-do-livro" class="section level2">
<h2><span class="header-section-number">1.2</span> Objetivos do Livro</h2>
<p>Este livro tem três objetivos principais:</p>
<ol style="list-style-type: decimal">
<li><p><strong>ilustrar e analisar o impacto das simplificações feitas ao utilizar pacotes usuais de análise de dados quando estes são provenientes de pesquisas amostrais complexas</strong>;</p></li>
<li><p><strong>apresentar uma coleção de métodos e recursos computacionais disponíveis para análise de dados amostrais complexos, equipando o analista para trabalhar com tais dados, reduzindo assim o risco de inferências incorretas</strong>;</p></li>
<li><p><strong>ilustrar o potencial analítico de muitas das pesquisas produzidas por agências de estatísticas oficiais para responder questões de interesse, mediante uso de ferramentas de análise estatística agora já bastante difundidas, aumentando assim o valor adicionado destas pesquisas</strong>.</p></li>
</ol>
<p>Para alcançar tais objetivos, adota-se uma abordagem fortemente ancorada na apresentação de exemplos de análises de dados obtidos em pesquisas amostrais complexas, usando pacotes clássicos e também recursos do pacote estatístico R (<a href="http://www.r-project.org/" class="uri">http://www.r-project.org/</a>). A comparação dos resultados das análises feitas das duas formas permite avaliar o impacto de não se considerar os pontos i) a iv) anteriormente citados. O ponto iv) não será tratado de forma completa neste texto. O leitor interessado na análise de dados sujeitos a não-resposta pode consultar <span class="citation">(Kalton <a href="#ref-kalton83a">1983</a><a href="#ref-kalton83a">a</a>)</span>, <span class="citation">(Little and Rubin <a href="#ref-LR2002">2002</a>)</span>, <span class="citation">(Rubin <a href="#ref-Rubin87">1987</a>)</span>, <span class="citation">(Särndal, Swensson, and Wretman <a href="#ref-SSW92">1992</a>)</span>, ou Schafer (1997), por exemplo.</p>
<p><strong>Estrutura do Livro</strong></p>
<p>O livro está organizado em catorze capítulos. Este primeiro capítulo discute a motivação para estudar o assunto e apresenta uma ideia geral dos objetivos e da estrutura do livro.</p>
<p>No segundo capítulo, procuramos dar uma visão das diferentes abordagens utilizadas na análise estatística de dados de pesquisas amostrais complexas. Apresentamos um referencial para inferência com ênfase no <code>Modelo de Superpopulação</code> que incorpora, de forma natural, tanto uma estrutura estocástica para descrever a geração dos dados populacionais (modelo) como o plano amostral efetivamente utilizado para obter os dados amostrais (plano amostral). As referências básicas para seguir este capítulo são cap2 em <span class="citation">(Nascimento Silva <a href="#ref-Silva">1996</a>)</span>, cap1 em <span class="citation">(Skinner, Holt, and Smith <a href="#ref-SHS89">1989</a>)</span> e caps 1 e 2 em <span class="citation">(Chambers and Skinner <a href="#ref-CHSK2003">2003</a>)</span>.</p>
<p>Esse referencial tem evoluído ao longo dos anos como uma forma de permitir a incorporação de idéias e procedimentos de análise e inferência usualmente associados à Estatística Clássica à prática da interpretação de dados provenientes de pesquisas amostrais. Apesar dessa evolução, sua adoção não é livre de controvérsia e uma breve revisão dessa discussão é apresentada no Capítulo <a href="refinf.html#refinf">2</a>.</p>
<p>No Capítulo <a href="capplanamo.html#capplanamo">3</a> apresentamos uma revisão sucinta, a título de recordação, de alguns resultados básicos da Teoria de Amostragem, requeridos nas partes subsequentes do livro. São discutidos os procedimentos básicos para estimação de totais considerando o plano amostral, e em seguida revistas algumas técnicas para estimação de variâncias úteis para o caso de estatísticas complexas, tais como razões e outras estatísticas requeridas na inferência analítica com dados amostrais. As referências centrais para este capítulo são caps 2 e 3 em <span class="citation">(Särndal, Swensson, and Wretman <a href="#ref-SSW92">1992</a>)</span>, <span class="citation">(Wolter <a href="#ref-W85">1985</a>)</span> e <span class="citation">(Cochran <a href="#ref-cochran">1977</a>)</span>.</p>
<p>No Capítulo <a href="introduc.html#epa">1.3</a> introduzimos o conceito de <code>Efeito do Plano Amostral (EPA)</code>, que permite avaliar o impacto de ignorar a estruturação dos dados populacionais ou do plano amostral sobre a estimativa da variância de um estimador. Para isso, comparamos o estimador da variância apropriado para dados obtidos por amostragem aleatória simples (hipótese de AAS) com o valor esperado deste mesmo estimador sob a distribuição de aleatorização induzida pelo plano amostral efetivamente utilizado (plano amostral verdadeiro). Aqui a referência principal foi o livro <span class="citation">(Skinner, Holt, and Smith <a href="#ref-SHS89">1989</a>)</span>, complementado com o texto de <span class="citation">(Lehtonen and Pahkinen <a href="#ref-lethonen">1995</a>)</span>.</p>
<p>No Capítulo <a href="ajmodpar.html#ajmodpar">5</a> estudamos a questão do uso de pesos ao analisar dados provenientes de pesquisas amostrais complexas, e introduzimos um método geral, denominado <code>Método de Máxima Pseudo Verossimilhança(MPV)</code>, para incorporar os pesos e o plano amostral na obtenção não só de estimativas de parâmetros dos modelos regulares de interesse, como também das variâncias dessas estimativas. As referências básicas utilizadas nesse capítulo foram <span class="citation">(Skinner, Holt, and Smith <a href="#ref-SHS89">1989</a>)</span>, <span class="citation">(Pfeffermann <a href="#ref-Pfeff">1993</a>)</span>, <span class="citation">(Binder <a href="#ref-binder83">1983</a>)</span> e cap.6 em <span class="citation">(Nascimento Silva <a href="#ref-Silva">1996</a>)</span>.</p>
<p>O Capítulo <a href="modreg.html#modreg">6</a> trata da obtenção de <code>Estimadores de Máxima Pseudo-Verossimilhança (EMPV)</code> e da respectiva matriz de covariância para os parâmetros em modelos de regressão linear e de regressão logística, quando os dados vêm de pesquisas amostrais complexas. Apresentamos um exemplo de aplicação com dados do Suplemento Trabalho da Pesquisa Nacional por Amostra de Domicílios (PNAD) de 90, onde ajustamos um modelo de regressão logística. Neste exemplo, são feitas comparações entre resultados de ajustes obtidos através de um programa especializado, a library <code>survey</code> <span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span>, e através de um programa de uso geral, a library <code>glm</code> do R. As referências centrais são cap6 em <span class="citation">(Nascimento Silva <a href="#ref-Silva">1996</a>)</span> e Binder(1983), além de <span class="citation">(Pessoa, Nascimento Silva, and Duarte <a href="#ref-Pessoa">1997</a>)</span>.</p>
<p>Os Capítulos <a href="testqualajust.html#testqualajust">7</a> e <a href="testetab2.html#testetab2">8</a> tratam da análise de dados categóricos com ênfase na adaptação dos testes clássicos para proporções, de independência e de homogeneidade em tabelas de contingência, para dados provenientes de pesquisas amostrais complexas. Apresentamos correções das estatísticas clássicas e a estatística de Wald baseada no plano amostral. As referências básicas usadas nesses capítulos foram os livros cap. 4, <span class="citation">(Skinner, Holt, and Smith <a href="#ref-SHS89">1989</a>)</span> e cap. 7 <span class="citation">(Lehtonen and Pahkinen <a href="#ref-lethonen">1995</a>)</span>. Também são apresentadas as idéias básicas de como efetuar ajuste de modelos log-lineares a dados de frequências em tabelas de múltiplas entradas.</p>
<p>O Capítulo <a href="estimacao-de-densidades.html#estimacao-de-densidades">9</a> trata da estimação de densidades e funções de distribuição, ferramentas que tem assumido importância cada dia maior com a maior disponibilidade de microdados de pesquisas amostrais para analistas fora das agências produtoras.</p>
<p>O Capítulo <a href="modelos-hierarquicos.html#modelos-hierarquicos">10</a> trata da estimação e ajuste de modelos hierárquicos considerando o plano amostral. Modelos hierárquicos (ou modelos multinível) têm sido bastante utilizados para explorar situações em que as relações entre variáveis de interesse em uma certa população de unidades elementares (por exemplo, crianças em escolas, pacientes em hospitais, empregados em empresas, moradores em regiões, etc.) são afetadas por efeitos de grupos determinados ao nível de unidades conglomeradas (os grupos). Ajustar e interpretar tais modelos é tarefa mais difícil que o mero ajuste de modelos lineares mesmo em casos onde os dados são obtidos de forma exaustiva, mas ainda mais complicada quando se trata de dados obtidos através de pesquisas amostrais complexas. Várias alternativas de métodos para ajuste de modelos hierárquicos estão disponíveis, e este capítulo apresenta uma revisão de tais abordagens, ilustrando com aplicações a dados de pesquisas amostrais de escolares.</p>
<p>O Capítulo <a href="nao-resposta.html#nao-resposta">11</a> trata da não resposta e suas conseqüências sobre a análise de dados. As abordagens de tratamento usuais, reponderação e imputação, são descritas de maneira resumida, com apresentação de alguns exemplos ilustrativos, e referências à ampla literatura existente sobre o assunto. Em seguida destacamos a importância de considerar os efeitos da não-resposta e dos tratamentos compensatórios aplicados nas análises dos dados resultantes, destacando em particular as ferramentas disponíveis para a estimação de variâncias na presença de dados incompletos tratados mediante reponderação e/ou imputação.</p>
<p>O Capítulo <a href="diagnostico-de-ajuste-de-modelo.html#diagnostico-de-ajuste-de-modelo">12</a> trata de assunto ainda emergente: diagnósticos do ajuste de modelos quando os dados foram obtidos de amostras complexas. A literatura sobre o assunto ainda é incipiente, mas o assunto é importante e procura-se estimular sua investigação com a revisão do estado da arte no assunto.</p>
<p>O Capítulo <a href="agregdesag.html#agregdesag">13</a> discute algumas formas alternativas de analisar dados de pesquisas complexas, contrapondo algumas abordagens distintas à que demos preferência nos capítulos anteriores, para dar aos leitores condições de apreciar de forma crítica o material apresentado no restante deste livro. Entre as abordagens discutidas, há duas principais: a denominada <code>análise desagregada</code>, e a abordagem denominada <code>obtenção  do modelo amostral</code> proposta por <span class="citation">(Pfeffermann, Krieger, and Rinott <a href="#ref-PKR">1998</a>)</span>. A chamada <code>análise desagregada</code> incorpora explicitamente na análise vários aspectos do plano amostral utilizado através do emprego de modelos hierárquicos <span class="citation">(Bryk and Raudenbush <a href="#ref-bryk">1992</a>)</span>. Em contraste, a abordagem adotada nos oito primeiros capítulos é denominada <code>análise agregada</code>, e procura <code>eliminar</code> da análise efeitos tais como conglomeração induzida pelo plano amostral, considerando tais efeitos como <code>ruídos</code> ou fatores de perturbação que <code>atrapalham</code> o emprego dos procedimentos clássicos de estimação, ajuste de modelos e teste de hipóteses.</p>
<p>A abordagem de <code>obtenção do modelo amostral</code> parte de um modelo de superpopulação e procura derivar o modelo amostral (ou que valeria para as observações da amostra obtida) considerando modelos para as probabilidades de inclusão dadas as variáveis auxiliares e as variáveis resposta de interesse. Uma vez obtidos tais modelos, seu ajuste prossegue por métodos convencionais tais como máxima verossimilhança ou mesmo MCMC (Markov Chain Monte Carlo).</p>
<p>Por último, no Capítulo <a href="pacotes.html#pacotes">14</a>, listamos alguns pacotes computacionais especializados disponíveis para a análise de dados de pesquisas amostrais complexas. Sem pretender ser exaustiva ou detalhada, essa revisão dos pacotes procura também apresentar suas características mais importantes. Vários destes programas podem ser adquiridos gratuitamente via <code>internet</code>, nos endereços fornecidos de seus produtores. Com isto pretendemos indicar aos leitores o caminho mais curto para permitir a implementação prática das técnicas e métodos aqui discutidos.</p>
<p>Uma das características que procuramos dar ao livro foi o emprego de exemplos com dados reais, retirados principalmente da experiência do IBGE com pesquisas amostrais complexas. Embora a experiência de fazer inferência analítica com dados desse tipo seja ainda incipiente no Brasil, acreditamos ser fundamental difundir essas idéias para alimentar um processo de melhoria do aproveitamento dos dados das inúmeras pesquisas realizadas pelo IBGE e instituições congêneres, que permita ir além da tradicional estimação de médias, totais, proporções e razões. Esperamos com esse livro fazer uma contribuição a esse processo.</p>
<p>Uma dificuldade em escrever um livro como este vem do fato de que não é possível começar do zero: é preciso assumir algum conhecimento prévio de idéias e conceitos necessários à compreensão do material tratado. Procuramos tornar o livro acessível para um estudante de fim de curso de graduação em Estatística. Por essa razão optamos por não apresentar provas de resultados e sempre que possível, apresentar os conceitos e idéias de maneira intuitiva, juntamente com uma discussão mais formal para dar solidez aos resultados apresentados. As provas de vários dos resultados aqui discutidos se restringem a material disponível apenas em artigos em periódicos especializados estrangeiros e portanto, são de acesso mais difícil. Ao leitor em busca de maior detalhamento e rigor, sugerimos consultar diretamente as inúmeras referências incluídas ao longo do texto. Para um tratamento mais profundo do assunto, os livros de <span class="citation">(Skinner, Holt, and Smith <a href="#ref-SHS89">1989</a>)</span> e <span class="citation">(Chambers and Skinner <a href="#ref-CHSK2003">2003</a>)</span> são as referências centrais a pesquisar. Para aqueles querendo um tratamento ainda mais prático que o nosso, o livro de <span class="citation">(Lehtonen and Pahkinen <a href="#ref-lethonen">1995</a>)</span> pode ser uma opção interessante.</p>
</div>
<div id="epa" class="section level2">
<h2><span class="header-section-number">1.3</span> Laboratório de R do Capítulo 1.</h2>

<div class="example">
<span id="exm:exe12" class="example"><strong>Exemplo 1.2  </strong></span>Utilização da library survey do R para estimar totais e razões na PPV
</div>
<p> Os exemplos a seguir utilizam dados da Pesquisa de Padrões de Vida (<code>PPV</code>) de 2004 do IBGE, cujo plano amostral encontra-se descrito no Exemplo <a href="introduc.html#exm:distppv">1.1</a> . Inicialmente, vamos ler os dados e definir variáveis de interesse por meio de transformação das variáveis existentes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># leitura dos dados</span>
ppv1 &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;~</span><span class="ch">\\</span><span class="st">GitHub</span><span class="ch">\\</span><span class="st">adac</span><span class="ch">\\</span><span class="st">data</span><span class="ch">\\</span><span class="st">ppv.rds&quot;</span>)
<span class="kw">library</span>(survey)</code></pre></div>
<p>Criação das variáveis analf1, analf2, faixa1 e faixa2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ppv1 &lt;-<span class="st"> </span><span class="kw">transform</span>(ppv1, 
<span class="dt">analf1 =</span> ((v04a01 <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>v04a02 <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span>(v02a08 <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>v02a08 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">14</span>)) <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, 
<span class="dt">analf2 =</span> ((v04a01 <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>v04a02 <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span>(v02a08 <span class="op">&gt;</span><span class="dv">14</span>)) <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, 
<span class="dt">faixa1 =</span> (v02a08 <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>v02a08 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">14</span>) <span class="op">*</span><span class="dv">1</span>, 
<span class="dt">faixa2 =</span> (v02a08 <span class="op">&gt;</span><span class="st"> </span><span class="dv">14</span>) <span class="op">*</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<p>A seguir, mostramos a utilização da library <code>survey</code> <span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span> do R para obter algumas estimativas da Tabela <a href="introduc.html#tab:epas">1.3</a>. Vamos supor que os dados da pesquisa estão contidos no data frame <code>ppv1</code>, que contém as variáveis que caracterizam o plano amostral</p>
<ul>
<li>nsetor - conglomerados;</li>
<li>estratof - estratos;</li>
<li>pesof - pesos do plano amostral;</li>
</ul>
<p>e variáveis de interesse tais como:</p>
<ul>
<li>regiao - regiões de abrangência: 1- Nordeste, 2- Sudeste;</li>
<li>analf1 - indicador de analfabeto na faixa etária de 7 a 14 anos;</li>
<li>analf2 - indicador de analfabeto na faixa etária acima de 14 anos;</li>
<li>faixa1 - indicador de idade entre 7 e 14 anos;</li>
<li>faixa2 - indicador de idade acima de 14 anos;</li>
</ul>
<p>O passo fundamental para utilização da library <code>survey</code> <span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span> é criar um objeto que guarde as informações relevantes do plano amostral. Isso é feito por meio da função <code>svydesign()</code>. As variáveis que definem estratos, conglomerados e pesos na <code>PPV</code> são respectivamente, <code>estratof</code>, <code>nsetor</code> e <code>pesof</code>. O objeto de desenho amostral, <code>ppv.des</code> incorpora as informações do plano amostral adotado na <code>PPV</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)
ppv.des&lt;-<span class="kw">svydesign</span>(<span class="dt">ids =</span> <span class="op">~</span>nsetor, <span class="dt">strata =</span> <span class="op">~</span>estratof,
<span class="dt">data =</span> ppv1, <span class="dt">nest =</span> <span class="ot">TRUE</span>, <span class="dt">weights =</span> <span class="op">~</span>pesof)</code></pre></div>
<p>Como todos os exemplos a seguir serão relativos a estimativas na Região Sudeste, vamos restringir o desenho a esse domínio:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ppv.se.des &lt;-<span class="st"> </span><span class="kw">subset</span>(ppv.des, regiao <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<p>Para exemplificar, vamos estimar algumas características da população, descritas na Tabela <a href="introduc.html#tab:epas">1.3</a>. Os totais das variáveis <code>analf1</code> e <code>analf2</code> para a região Sudeste fornecem os resultados nas linhas 4 e 5 da Tabela <a href="introduc.html#tab:epas">1.3</a>:</p>
<ul>
<li>totais de analfabetos nas faixas etárias de 7 a 14 anos e acima de 14 anos.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svytotal</span>(<span class="op">~</span>analf1, ppv.se.des, <span class="dt">deff =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##          total      SE   DEff
## analf1 1174220  127982 2.0543</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svytotal</span>(<span class="op">~</span>analf2, ppv.se.des, <span class="dt">deff =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##          total      SE   DEff
## analf2 4792344  318877 3.3237</code></pre>
<ul>
<li>percentual de analfabetos nas faixas etárias consideradas, que fornece os resultados nas linhas 6 e 7 da Tabela <a href="introduc.html#tab:epas">1.3</a>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyratio</span>(<span class="op">~</span>analf1, <span class="op">~</span>faixa1, ppv.se.des)</code></pre></div>
<pre><code>## Ratio estimator: svyratio.survey.design2(~analf1, ~faixa1, ppv.se.des)
## Ratios=
##          faixa1
## analf1 0.118689
## SEs=
##            faixa1
## analf1 0.01178896</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyratio</span>(<span class="op">~</span>analf2, <span class="op">~</span>faixa2, ppv.se.des)</code></pre></div>
<pre><code>## Ratio estimator: svyratio.survey.design2(~analf2, ~faixa2, ppv.se.des)
## Ratios=
##           faixa2
## analf2 0.1086871
## SEs=
##             faixa2
## analf2 0.006732254</code></pre>
<p>Na library <code>survey</code> <span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span>, uma alternativa para estimar por domínio é utilizar a função <code>svyby</code>. Poderíamos estimar os totais da variável <code>analf1</code> para as regiões <code>Nordeste (1)</code> e <code>Sudeste(2)</code> da seguinte forma:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svyby</span>(<span class="op">~</span>analf1, <span class="op">~</span>regiao, ppv.des, svytotal, <span class="dt">deff =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##   regiao  analf1       se DEff.analf1
## 1      1 3512866 352619.5    9.660561
## 2      2 1174220 127982.2    2.054345</code></pre>
<p>Observe que as estimativas de totais e desvios padrão obtidas coincidem com as Tabela <a href="introduc.html#tab:epas">1.3</a>, porém as estimativas de Efeitos de Plano Amostral(DEff) são distintas.</p>

<div class="example">
<span id="exm:exe13" class="example"><strong>Exemplo 1.3  </strong></span>Exemplo anterior usando a library srvyr
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># leitura dos dados</span>
ppv1 &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;~</span><span class="ch">\\</span><span class="st">GitHub</span><span class="ch">\\</span><span class="st">adac</span><span class="ch">\\</span><span class="st">data</span><span class="ch">\\</span><span class="st">ppv.rds&quot;</span>)</code></pre></div>
<p>Carrega a library <code>srvyr</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(srvyr)</code></pre></div>
<p>Cria objeto de desenho:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ppv.des &lt;-<span class="st"> </span>ppv1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_survey_design</span> (<span class="dt">ids =</span> nsetor, <span class="dt">strata =</span> estratof,
<span class="dt">nest =</span> <span class="ot">TRUE</span>, <span class="dt">weights =</span> pesof)</code></pre></div>
<p>Vamos criar novas variáveis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ppv.des &lt;-<span class="st"> </span>ppv.des <span class="op">%&gt;%</span><span class="st"> </span>
<span class="kw">mutate</span>(
<span class="dt">analf1 =</span> <span class="kw">as.numeric</span>((v04a01 <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>v04a02 <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span>(v02a08 <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>v02a08 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">14</span>)), 
<span class="dt">analf2 =</span> <span class="kw">as.numeric</span>((v04a01 <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>v04a02 <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span>(v02a08 <span class="op">&gt;</span><span class="dv">14</span>)), 
<span class="dt">faixa1 =</span> <span class="kw">as.numeric</span>(v02a08 <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span> <span class="op">&amp;</span><span class="st"> </span>v02a08 <span class="op">&lt;=</span><span class="st"> </span><span class="dv">14</span>), 
<span class="dt">faixa2 =</span> <span class="kw">as.numeric</span>(v02a08 <span class="op">&gt;</span><span class="st"> </span><span class="dv">14</span>)   
)</code></pre></div>
<p>Estimar a taxa de analfabetos por região para as faixas etárias de 7-14 anos e mais de 14 anos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span>ppv.des <span class="op">%&gt;%</span><span class="st">  </span>
<span class="kw">group_by</span>(regiao) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="kw">summarise</span>(
<span class="dt">taxa_analf1 =</span> <span class="kw">survey_ratio</span>(analf1, faixa1),
<span class="dt">taxa_analf2 =</span> <span class="kw">survey_ratio</span>(analf2, faixa2)  
)
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">as_tibble</span>(res), <span class="dt">booktabs =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">format =</span> <span class="st">&quot;latex&quot;</span>, 
<span class="dt">caption =</span> <span class="st">&quot;Proporção de analfabetos para faixas etárias 7-14 anos e mais de 14 anos&quot;</span>)</code></pre></div>

<div id="estimativa-do-efeito-de-plano-amostral-epa" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Estimativa do efeito de plano amostral (EPA)</h3>
<p>Esse assunto será tratado em detalhes no Capítulo <a href="introduc.html#epa">1.3</a> . Por enquanto, apresentaremos uma introdução necessária para compreender os valores na Tabela <a href="introduc.html#tab:epas">1.3</a>.</p>
<p>O efeito de plano amostral (EPA) de Kish é definido na fórmula <a href="epa.html#eq:epa1">(4.1)</a>. Vamos considerar o caso particular em que <span class="math inline">\(\hat{\theta}\)</span> é um estimador de total de uma variável <span class="math inline">\(Y\)</span>.Ou seja <span class="math display">\[
EPA_{Kish}\left(\widehat{Y}\right)=\frac{V_{VERD}\left(\widehat{Y}\right)}{V_{AAS}\left(\widehat{Y}\right)}
\]</span></p>
<p>Na definição do EPA, a estimativa do numerador pode ser obtida usando-se a library <code>survey</code> <span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span>, a partir do objeto de <code>ppv.se.des</code> que incorpora as características do plano amostral utilizado para coletar os dados. Não é possível estimar diretamente o denominador, pois o plano amostral AAS (Amostragem Aleatória Simples) não foi adotado na coleta dos dados. Devemos estimar o denominador a partir de dados obtidos através do plano amostral VERD, como se eles tivessem sido obtidos através de AAS.</p>
<p>Supondo conhecido o tamanho da população <span class="math inline">\(N\)</span> e a fração amostral <span class="math inline">\(f=n/N\)</span> pequena, a estimativa da variância de <span class="math inline">\(\widehat{Y}\)</span> é dada na expressão <a href="capplanamo.html#eq:estpa9">(3.9)</a> <span class="math display">\[
\widehat{V}_{AAS}\left(\widehat{Y}\right)=N^2\frac{\widehat{S}_y}{n-1}
\]</span> onde <span class="math inline">\(\widehat{S}_y= n^{-1}\sum_{i\in s}\left(y_i-\overline{y}\right)^2\)</span> é a estimativa de <span class="math inline">\(S_y=N^{-1}\sum_{i\in U}\left(y_i-\overline{Y}\right)^2\)</span>, com <span class="math inline">\(\overline{Y}=N^{-1}Y\)</span>.</p>
No lugar dessa estimativa, vamos utilizar os pesos do plano amostral verdadeiro para estimar <span class="math inline">\(S_y\)</span>. Vamos ainda estimar <span class="math inline">\(N\)</span>, em geral é desconhecido, por <span class="math inline">\(\widehat{N}=\sum_{i \in s} w_i\)</span>. Dessa forma obtemos a estimativa
<span class="math display">\[\begin{eqnarray*}
\widehat{V}_{w-AAS}\left(\widehat{Y}\right)&amp;=&amp; \widehat{N}^2\left[\sum_{i \in s}w_i\left(y_i-\overline{y}\right)^2/\widehat{N}\right]/(n-1)\\
&amp;=&amp;\frac{\widehat{N}}{n-1}\left[\sum_{i \in s}w_iy_i^2-\left(\sum_{i \in s}w_iy_i\right)^2/\widehat{N}\right],
\end{eqnarray*}\]</span>
<p>onde <span class="math inline">\(\overline{y}=\sum_{i \in s}w_iy_i/n\)</span>.</p>
<p>A expressão acima pode ser calculada facilmente através da seguinte função do R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Vwaas&lt;-<span class="cf">function</span>(y,w)
{
<span class="co">#função auxiliar usada em outras funções</span>
<span class="co">#entrada:</span>
<span class="co">#y - valores de variavel na amostra;</span>
<span class="co">#w - pesos amostrais;</span>
<span class="co">#saida:  estimativa de variância de desenho para o total (segundo o SUDAAN)</span>

n1&lt;-<span class="kw">length</span>(y)<span class="op">-</span><span class="dv">1</span>
wsum&lt;-<span class="kw">sum</span>(y<span class="op">*</span>w)
wsum2&lt;-<span class="kw">sum</span>((y<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>w)
nhat&lt;-<span class="kw">sum</span>(w)
vwaas&lt;-(nhat<span class="op">/</span>n1)<span class="op">*</span>(wsum2<span class="op">-</span>wsum<span class="op">^</span><span class="dv">2</span><span class="op">/</span>nhat)
vwaas
}</code></pre></div>
<p>Vamos utilizar a função <code>Vwaas</code> para estimar os valores de <code>Efeitos do Plano Amostral</code> das estimativas de totais apresentadas anteriormente. Consideremos o plano amostral <code>ppv.se.des</code> anteriormente definido. Vamos usar a função <code>Vwaas</code> para obter uma estimativa da variância do total estimado da variável <code>analf1</code>. Todos os elementos os elementos necessários estão contidos no objeto <code>ppv.se.des</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">VAAS1&lt;-<span class="st"> </span><span class="kw">Vwaas</span>(ppv.se.des<span class="op">$</span>variables[,<span class="st">&quot;analf1&quot;</span>],<span class="kw">weights</span>(ppv.se.des))
VAAS2&lt;-<span class="st"> </span><span class="kw">Vwaas</span>(ppv.se.des<span class="op">$</span>variables[,<span class="st">&quot;analf2&quot;</span>],<span class="kw">weights</span>(ppv.se.des))</code></pre></div>
<p>O efeito de plano amostral da estimativa do total de <code>analf1</code> pode agora ser calculada por</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attr</span>(<span class="kw">svytotal</span>(<span class="op">~</span>analf1, ppv.se.des),<span class="st">&quot;var&quot;</span>)<span class="op">/</span>VAAS1</code></pre></div>
<pre><code>##          analf1
## analf1 2.054049</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attr</span>(<span class="kw">svytotal</span>(<span class="op">~</span>analf2, ppv.se.des),<span class="st">&quot;var&quot;</span>)<span class="op">/</span>VAAS2</code></pre></div>
<pre><code>##         analf2
## analf2 3.32324</code></pre>
<p>Esses valores do EPA coincidem com os obtidos acima através da library <code>survey</code><span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span> e são distintos daqueles apresentados na Tabela <a href="introduc.html#tab:epas">1.3</a>. Para obter os valores correspondentes aos da Tabela <a href="introduc.html#tab:epas">1.3</a>, através da library <code>survey</code><span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span>, vamos definir as variáveis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">analf1.se&lt;-<span class="kw">with</span>(ppv1,((v04a01<span class="op">==</span><span class="dv">2</span><span class="op">|</span>v04a02<span class="op">==</span><span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span>(v02a08<span class="op">&gt;=</span><span class="dv">7</span><span class="op">&amp;</span>v02a08<span class="op">&lt;=</span><span class="dv">14</span>))<span class="op">&amp;</span>(regiao<span class="op">==</span><span class="dv">2</span>))
analf2.se&lt;-<span class="kw">with</span>(ppv1,((v04a01<span class="op">==</span><span class="dv">2</span><span class="op">|</span>v04a02<span class="op">==</span><span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span>(v02a08<span class="op">&gt;</span><span class="dv">14</span>))<span class="op">&amp;</span>(regiao<span class="op">==</span><span class="dv">2</span>))
ppv.des &lt;-<span class="st"> </span><span class="kw">update</span> (ppv.des,<span class="dt">analf1.se=</span>analf1.se,<span class="dt">analf2.se=</span>analf2.se  )
<span class="kw">svytotal</span>(analf1.se,ppv.des,<span class="dt">deff=</span>T)</code></pre></div>
<pre><code>##        total      SE   DEff
## [1,] 1174220  127982 2.6426</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svytotal</span>(analf2.se,ppv.des,<span class="dt">deff=</span>T)</code></pre></div>
<pre><code>##        total      SE   DEff
## [1,] 4792344  318877 4.1667</code></pre>
<p>Ou, alternativamente,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svytotal</span>(<span class="op">~</span><span class="kw">I</span>(<span class="kw">ifelse</span>(regiao<span class="op">==</span><span class="dv">2</span>,analf1,<span class="dv">0</span>)),ppv.des,<span class="dt">deff=</span>T)</code></pre></div>
<pre><code>##                                     total      SE   DEff
## I(ifelse(regiao == 2, analf1, 0)) 1174220  127982 2.6426</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">svytotal</span>(<span class="op">~</span><span class="kw">I</span>(<span class="kw">ifelse</span>(regiao<span class="op">==</span><span class="dv">2</span>,analf2,<span class="dv">0</span>)),ppv.des,<span class="dt">deff=</span>T)</code></pre></div>
<pre><code>##                                     total      SE   DEff
## I(ifelse(regiao == 2, analf2, 0)) 4792344  318877 4.1667</code></pre>
<p>Observe que as estimativas de variância para o desenho verdadeiro (numerador do EPA) são iguais quando usamos: a variável <code>analf1.se</code> com o objeto de desenho <code>ppv.des</code> ou a variável <code>analf1</code> com o objeto <code>ppv.se.des</code>. Porém na estimativa do denominador do EPA, obtida a partir da função <code>Vwaas</code>, obtemos resultados diferentes quando usamos <code>analf1.se</code> ou <code>analf1</code>, com os pesos correspondentes. No segundo caso, a soma dos pesos não estima <span class="math inline">\(N\)</span>. Deve-se ter o cuidado, quando estimamos em um domínio, de trabalhar com pesos cuja soma seja um estimador do tamanho da população.</p>

<div class="example">
<span id="exm:exe14" class="example"><strong>Exemplo 1.4  </strong></span>Utilização da library survey do R para estimar taxa de desocupação para um trimestre na PNADC
</div>

<ul>
<li>Instala library <code>lodown</code> <span class="citation">(Damico <a href="#ref-R-lodown">2016</a>)</span> do github:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">&quot;ajdamico/lodown&quot;</span>)</code></pre></div>
<ul>
<li>carrega a library para ler os dados da PNADC</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lodown)</code></pre></div>
<ul>
<li>Baixa catálogo da PNADC com arquivos disponíveis:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pnadc_cat &lt;-<span class="st"> </span><span class="kw">get_catalog</span>( <span class="st">&quot;pnadc&quot;</span> , <span class="dt">output_dir =</span><span class="kw">tempdir</span>() )</code></pre></div>
<p>Os microdados de interesse são terceiro trimestre de 2016. Vamos ler os microdados e salvá-los em um data frame <code>x</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lodown</span>( <span class="st">&quot;pnadc&quot;</span> , <span class="kw">subset</span>( pnadc_cat , year <span class="op">==</span><span class="st"> </span><span class="dv">2016</span> <span class="op">&amp;</span><span class="st"> </span>quarter <span class="op">==</span><span class="st"> &#39;03&#39;</span> ) )
x &lt;-<span class="st"> </span><span class="kw">readRDS</span>( <span class="kw">paste0</span>( <span class="kw">tempdir</span>() , <span class="st">&quot;/pnadc 2016 03.rds&quot;</span> ) )</code></pre></div>
<p>vamos salvar o data frame <code>x</code> para uso posterior, :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(x, <span class="dt">file=</span><span class="st">&quot;C:/adac/pnadc/pnadc 2016 03.rds&quot;</span>)</code></pre></div>
<p>Partindo do arquivo <code>pnadc 2016 03.rds</code>, podemos recuperar o data frame <code>x</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;C:/adac/pnadc/pnadc 2016 03.rds&quot;</span>)</code></pre></div>
<ul>
<li>Carrega a library <code>survey</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)</code></pre></div>
<ul>
<li>Fixa opção para caso de UPA única no estrato</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>( <span class="dt">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span> )</code></pre></div>
<ul>
<li>Cria versão inicial de objeto de desenho:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pre_w &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span><span class="op">~</span>upa, <span class="dt">strata=</span><span class="op">~</span>estrato, 
  <span class="dt">weights=</span><span class="op">~</span>v1027, <span class="dt">data =</span> x, <span class="dt">nest=</span><span class="ot">TRUE</span>)</code></pre></div>
<ul>
<li>Especifica totais de pós-estratos na população:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_pos &lt;-<span class="kw">data.frame</span>(<span class="dt">posest=</span><span class="kw">unique</span>(x<span class="op">$</span>posest), 
  <span class="dt">Freq=</span><span class="kw">unique</span>(x<span class="op">$</span>v1029))</code></pre></div>
<ul>
<li>Pós-estratifica objeto de desenho inicial:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w &lt;-<span class="kw">postStratify</span>(pre_w, <span class="op">~</span>posest, df_pos)</code></pre></div>
<p>Para calcular a taxa de desocupação, o IBGE considera pessoas de 14 anos ou mais na semana de referência(PIA) e calcula a razão de dois totais:</p>
<ol style="list-style-type: decimal">
<li><p>Numerador: total de pessoas desocupadas (vd4002==2)</p></li>
<li><p>Denominador: total de pessoas na força de trabalho (vd4001==1)</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estima taxa de desocupação</span>
taxa_des &lt;-<span class="st"> </span><span class="kw">svyratio</span>(<span class="op">~</span><span class="st"> </span>vd4002<span class="op">==</span><span class="st">&quot;2&quot;</span> ,
  <span class="op">~</span><span class="st"> </span>vd4001 <span class="op">==</span><span class="st"> &quot;1&quot;</span> , w , <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
<span class="co"># organiza saída</span>
result &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dv">100</span><span class="op">*</span><span class="kw">coef</span>(taxa_des),
  <span class="dv">100</span><span class="op">*</span><span class="kw">SE</span>(taxa_des), 
  <span class="dv">100</span><span class="op">*</span><span class="kw">cv</span>(taxa_des)
)
<span class="kw">row.names</span>(result)&lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">names</span>(result) &lt;-<span class="ot">NULL</span>
<span class="kw">names</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Taxa&quot;</span>, <span class="st">&quot;Erro_Padrao&quot;</span>, <span class="st">&quot;CV&quot;</span>)
<span class="co"># taxa de desocupação</span>
result</code></pre></div>
<pre><code>##       Taxa Erro_Padrao        CV
## 1 11.80303   0.1174791 0.9953299</code></pre>

<div class="example">
<span id="exm:exe15" class="example"><strong>Exemplo 1.5  </strong></span>Utilização da library survey do R para análise de microdados da PNS
</div>

<p>Leitura dos microdados usando a library <code>lodown</code><span class="citation">(Damico <a href="#ref-R-lodown">2016</a>)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(lodown)</span>
<span class="co">#lodown( &quot;pns&quot; , output_dir = &quot;C:/adac/PNS&quot;)</span></code></pre></div>
<p>Depois de baixar os dados, são criados os seguintes arquivos no diretório <code>C:/adac/PNS</code> :</p>
<ol style="list-style-type: decimal">
<li><p><code>2013 all questionnaire survey design.rds</code> que contém o objeto de desenho para todos as pessoas na amostra;</p></li>
<li><p><code>2013 all questionnaire survey.rds</code> que contém os microdados para todos as pessoas da amostra</p></li>
<li><p><code>2013 long questionnaire survey design.rds</code> que contém o objeto de desenho para uma subamostra de pessoas com 18 anos ou mais que responderam um questionário mais longo;</p></li>
<li><p><code>2013 long questionnaire survey.rds</code> que contém os microdados para uma subamostra de pessoas com 18 anos ou mais que responderam um questionário mais longo;</p></li>
</ol>

<div class="remark">
 <span class="remark"><em>Observação. </em></span> Nos arquivos acima, além das variáveis contidas no dicionário da PNS, foram acrescentadas variáveis derivadas, utilizadas nos exemplos no site <a href="https://github.com/ajdamico/asdfree/tree/master/Pesquisa%20Nacional%20De%20Saude">asdfree.com</a>
</div>

<p>Inicialmente, vamos estimar características de pessoas com 18 anos ou mais mais que responderam o questionário longo e salvar os microdados dessa amostra no data frame <code>pes_sel</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pes_sel &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;C:/adac/PNS/2013 long questionnaire survey.rds&quot;</span>)
<span class="kw">dim</span>(pes_sel)</code></pre></div>
<pre><code>## [1] 60202  1019</code></pre>

<div class="remark">
 <span class="remark"><em>Observação. </em></span> No data frame pes_sel o nome das variáveis, obtidos por <code>names(pes_sel)</code>, estão em minúsculas. No dicionário da PNS os códigos correspondentes estão em maiúsculas.
</div>
<p> O data frame <code>pes_sel</code> contém as variáveis descritas no dicionário da <code>PNS</code> e algumas variáveis obtidas derivadas.</p>
<p>O passo inicial para a análise dos microdados é definir um objeto de desenho que salva as características do plano amostral da pesquisa. Isso é feito por meio da função <code>svydesign()</code> da library <code>survey</code> <span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)
pes_sel_des &lt;-
<span class="st">    </span><span class="kw">svydesign</span>(
        <span class="dt">id =</span> <span class="op">~</span><span class="st"> </span>upa_pns ,
        <span class="dt">strata =</span> <span class="op">~</span><span class="st"> </span>v0024 ,
        <span class="dt">data =</span> pes_sel ,
        <span class="dt">weights =</span> <span class="op">~</span><span class="st"> </span>pre_pes_long ,
        <span class="dt">nest =</span> <span class="ot">TRUE</span>
    )</code></pre></div>
<p>Os pesos do objeto de desenho <code>pes_sel_des</code> devem ser modificados de modo que as estimativas dos totais populacionais dos pós-estratos fixados coincidam com os totais populacionais dos pós-estratos conhecidos a partir do Censo Demográfico. O data frame <code>post_pop</code> contém na primeira coluna a identidade dos pós-estratos e na segunda seus totais populacionais.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">post_pop &lt;-<span class="st"> </span><span class="kw">unique</span>( pes_sel[ <span class="kw">c</span>( <span class="st">&#39;v00293.y&#39;</span> , <span class="st">&#39;v00292.y&#39;</span> ) ] )
<span class="kw">names</span>( post_pop ) &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;v00293.y&quot;</span> , <span class="st">&quot;Freq&quot;</span> )</code></pre></div>
<p>Utilizando a função <code>postStratify()</code> da library <code>survey</code> <span class="citation">(Lumley <a href="#ref-R-survey">2017</a>)</span> incorpora-se no objeto de desenho <code>pes_sel_des</code> as informações contidas no data frame <code>post_pop</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pes_sel_des_pos &lt;-<span class="st"> </span><span class="kw">postStratify</span>( pes_sel_des , <span class="op">~</span>v00293.y , post_pop )</code></pre></div>
<p>Os comandos acimas foram apresentados apenas para ilustrar como, a partir dos microdados da pesquisa, obtemos o objeto de desenho da pesquisa. Não seria necessária a execução desses comandos pois o objeto de desenho <code>pes_sel_des_pos</code> já se encontra disponível no arquivo 1 <code>2013 all questionnaire survey design.rds</code>.</p>
<p>Para exemplificar, vamos agora reproduzir estimativas na Tabela 6.42.1.1 da publicação em <a href="ftp://ftp.ibge.gov.br/PNS/2013/pns2013.pdf" class="uri">ftp://ftp.ibge.gov.br/PNS/2013/pns2013.pdf</a>.</p>
<p>A variável de interesse tem código Q092 e sua descrição é: “Algum médico ou profissional de saúde mental (como psiquiatra ou psicólogo) já lhe deu o diagnóstico de depressão?”</p>
<p>Essa variável é de classe <code>character</code> e tem dois valores “1” e “2”. Vamos definir uma nova variável <code>diag_dep</code> que é igual a 1 se recebe diagnóstico de depressão e 0 caso contrário:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diag_dep &lt;-<span class="st"> </span><span class="kw">as.numeric</span> (pes_sel<span class="op">$</span>q092<span class="op">==</span><span class="st">&quot;1&quot;</span>)</code></pre></div>
<p>Como mencionado, o objeto de desenho pós-estratificado <code>pes_sel_des_pos</code> pode ser lido do arquivo <code>2013 all questionnaire survey design.rds</code>. Vamos atualizar o objeto de desenho <code>pes_sel_des_pos</code> para incluir a variável <code>diad_dep</code> na componente <code>variables</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pes_sel_des_pos &lt;-<span class="st"> </span><span class="kw">update</span> (pes_sel_des_pos, <span class="dt">diag_dep =</span> diag_dep )</code></pre></div>
<p>Para calcular a proporção de pessoas que receberam diagnóstico de depressão para o país inteiro usamos o seguinte comando:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diagdepbr &lt;-<span class="st"> </span><span class="kw">svymean</span>(<span class="op">~</span>diag_dep, pes_sel_des_pos)
<span class="co"># estimativa em e % e erro padrão</span>
<span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="st"> </span><span class="kw">coef</span>(diagdepbr),<span class="dv">1</span>)</code></pre></div>
<pre><code>## diag_dep 
##      7.6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">SE</span>(diagdepbr),<span class="dv">1</span>)</code></pre></div>
<pre><code>##          diag_dep
## diag_dep      0.2</code></pre>
<p>e para obter um intervalo de confiança aproximado com nível de confiança de 95%, usamos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">coef</span>(diagdepbr) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">SE</span>(diagdepbr),<span class="kw">coef</span>(diagdepbr) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">SE</span>(diagdepbr)  ), <span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 7.2 8.1</code></pre>
<p>As estimativa de proporção e os limites do intervalo de confiança podem ser obtidos por meio da função:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">three_stats &lt;-<span class="st"> </span><span class="cf">function</span>(z) <span class="kw">round</span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">coef</span>(z), <span class="kw">coef</span>(z) <span class="op">-</span><span class="st"> </span>
<span class="st">  </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">SE</span>(z), <span class="kw">coef</span>(z) <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">SE</span>(z)), <span class="dv">1</span>)</code></pre></div>
<p>Aplicando a função <code>three_stats</code> para estimar a proporção para o país inteiro:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">three_stats</span>(diagdepbr)</code></pre></div>
<pre><code>## diag_dep                   
##      7.6      7.2      8.1</code></pre>
<p>que coincidem com os resultados já obtidos.</p>
<p>Para o país por sexo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diagdepsex &lt;-<span class="st"> </span><span class="kw">svyby</span>(<span class="op">~</span>diag_dep, <span class="op">~</span>c006, <span class="dt">design =</span> pes_sel_des_pos, 
  svymean)
res &lt;-<span class="st"> </span><span class="kw">three_stats</span>(diagdepsex)
dfsex &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">sexo =</span> <span class="kw">names</span>(res)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">prop =</span> res[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">l.i.c. =</span> res[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">l.s.c =</span>res[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>])
knitr<span class="op">::</span><span class="kw">kable</span>(dfsex,<span class="dt">booktabs =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">format =</span> <span class="st">&quot;latex&quot;</span>, 
<span class="dt">caption =</span> <span class="st">&quot;Proporção de diagnóstico de depressão por sexo&quot;</span>)</code></pre></div>

<p>Por situação (rural e urbano)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diagdepsitu &lt;-<span class="st"> </span><span class="kw">svyby</span>(<span class="op">~</span>diag_dep, <span class="op">~</span>situ, <span class="dt">design =</span> pes_sel_des_pos, 
  svymean)
res &lt;-<span class="st"> </span><span class="kw">three_stats</span>(diagdepsitu)
dfsitu &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">situ =</span> <span class="kw">names</span>(res)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">prop =</span> res[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">l.i.c. =</span> res[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">l.s.c =</span>res[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>])
knitr<span class="op">::</span><span class="kw">kable</span>(dfsitu,<span class="dt">booktabs =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, 
<span class="dt">caption =</span> <span class="st">&quot;Proporção de diagnóstico de depressão por situação&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-48">Tabela 1.4: </span>Proporção de diagnóstico de depressão por situação</caption>
<thead>
<tr class="header">
<th align="left">situ</th>
<th align="right">prop</th>
<th align="right">l.i.c.</th>
<th align="right">l.s.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">urbano</td>
<td align="right">8.0</td>
<td align="right">7.5</td>
<td align="right">8.4</td>
</tr>
<tr class="even">
<td align="left">rural</td>
<td align="right">5.6</td>
<td align="right">4.9</td>
<td align="right">6.3</td>
</tr>
</tbody>
</table>
<p>Por Unidade da Federação:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diagdepuf &lt;-<span class="st"> </span><span class="kw">svyby</span>(<span class="op">~</span>diag_dep, <span class="op">~</span>uf, <span class="dt">design =</span> pes_sel_des_pos, svymean)
res &lt;-<span class="st"> </span><span class="kw">three_stats</span>(diagdepuf)
dfuf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">uf =</span> <span class="kw">names</span>(res)[<span class="dv">1</span><span class="op">:</span><span class="dv">27</span>], <span class="dt">prop =</span> res[<span class="dv">1</span><span class="op">:</span><span class="dv">27</span>], 
  <span class="dt">l.i.c. =</span> res[<span class="dv">28</span><span class="op">:</span><span class="dv">54</span>], <span class="dt">l.s.c =</span>res[<span class="dv">55</span><span class="op">:</span><span class="dv">81</span>]  )
knitr<span class="op">::</span><span class="kw">kable</span>(dfuf,<span class="dt">booktabs =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, 
<span class="dt">caption =</span> <span class="st">&quot;Proporção de diagnóstico de depressão por uf&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-50">Tabela 1.5: </span>Proporção de diagnóstico de depressão por uf</caption>
<thead>
<tr class="header">
<th align="left">uf</th>
<th align="right">prop</th>
<th align="right">l.i.c.</th>
<th align="right">l.s.c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Rondonia</td>
<td align="right">5.6</td>
<td align="right">4.1</td>
<td align="right">7.2</td>
</tr>
<tr class="even">
<td align="left">Acre</td>
<td align="right">5.8</td>
<td align="right">4.5</td>
<td align="right">7.2</td>
</tr>
<tr class="odd">
<td align="left">Amazonas</td>
<td align="right">2.7</td>
<td align="right">1.9</td>
<td align="right">3.5</td>
</tr>
<tr class="even">
<td align="left">Roraima</td>
<td align="right">4.4</td>
<td align="right">3.2</td>
<td align="right">5.7</td>
</tr>
<tr class="odd">
<td align="left">Para</td>
<td align="right">1.6</td>
<td align="right">1.0</td>
<td align="right">2.1</td>
</tr>
<tr class="even">
<td align="left">Amapa</td>
<td align="right">3.4</td>
<td align="right">2.0</td>
<td align="right">4.7</td>
</tr>
<tr class="odd">
<td align="left">Tocantins</td>
<td align="right">7.1</td>
<td align="right">5.2</td>
<td align="right">8.9</td>
</tr>
<tr class="even">
<td align="left">Maranhao</td>
<td align="right">3.8</td>
<td align="right">2.4</td>
<td align="right">5.1</td>
</tr>
<tr class="odd">
<td align="left">Piaui</td>
<td align="right">3.9</td>
<td align="right">2.8</td>
<td align="right">5.1</td>
</tr>
<tr class="even">
<td align="left">Ceara</td>
<td align="right">4.4</td>
<td align="right">3.3</td>
<td align="right">5.4</td>
</tr>
<tr class="odd">
<td align="left">Rio Grande do Norte</td>
<td align="right">6.9</td>
<td align="right">5.4</td>
<td align="right">8.4</td>
</tr>
<tr class="even">
<td align="left">Paraiba</td>
<td align="right">4.8</td>
<td align="right">3.4</td>
<td align="right">6.2</td>
</tr>
<tr class="odd">
<td align="left">Pernambuco</td>
<td align="right">7.2</td>
<td align="right">5.7</td>
<td align="right">8.6</td>
</tr>
<tr class="even">
<td align="left">Alagoas</td>
<td align="right">6.2</td>
<td align="right">4.6</td>
<td align="right">7.9</td>
</tr>
<tr class="odd">
<td align="left">Sergipe</td>
<td align="right">6.2</td>
<td align="right">4.9</td>
<td align="right">7.5</td>
</tr>
<tr class="even">
<td align="left">Bahia</td>
<td align="right">4.0</td>
<td align="right">2.7</td>
<td align="right">5.3</td>
</tr>
<tr class="odd">
<td align="left">Minas Gerais</td>
<td align="right">11.1</td>
<td align="right">9.0</td>
<td align="right">13.1</td>
</tr>
<tr class="even">
<td align="left">Espirito Santo</td>
<td align="right">5.5</td>
<td align="right">3.7</td>
<td align="right">7.2</td>
</tr>
<tr class="odd">
<td align="left">Rio de Janeiro</td>
<td align="right">6.0</td>
<td align="right">5.0</td>
<td align="right">7.0</td>
</tr>
<tr class="even">
<td align="left">Sao Paulo</td>
<td align="right">8.4</td>
<td align="right">7.3</td>
<td align="right">9.5</td>
</tr>
<tr class="odd">
<td align="left">Parana</td>
<td align="right">11.7</td>
<td align="right">9.4</td>
<td align="right">14.0</td>
</tr>
<tr class="even">
<td align="left">Santa Catarina</td>
<td align="right">12.9</td>
<td align="right">9.7</td>
<td align="right">16.0</td>
</tr>
<tr class="odd">
<td align="left">Rio Grande do Sul</td>
<td align="right">13.2</td>
<td align="right">11.5</td>
<td align="right">15.0</td>
</tr>
<tr class="even">
<td align="left">Mato Grosso do Sul</td>
<td align="right">8.8</td>
<td align="right">7.3</td>
<td align="right">10.4</td>
</tr>
<tr class="odd">
<td align="left">Mato Grosso</td>
<td align="right">6.9</td>
<td align="right">5.1</td>
<td align="right">8.7</td>
</tr>
<tr class="even">
<td align="left">Goias</td>
<td align="right">7.1</td>
<td align="right">5.7</td>
<td align="right">8.5</td>
</tr>
<tr class="odd">
<td align="left">Distrito Federal</td>
<td align="right">6.2</td>
<td align="right">4.9</td>
<td align="right">7.5</td>
</tr>
</tbody>
</table>
<p>Usando o objeto de desenho para todas as pessoas que reponderam o questionário curto, salvo no arquivo em <code>2013 all questionnaire survey design.rds</code>, vamos estimar a proporção de pessoas que possuem plano de saúde por grupos de nível de instrução.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pes_all_des_pos &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;C:/adac/PNS/2013 all questionnaire survey design.rds&quot;</span>)</code></pre></div>
<p>Proporção de pessoas com seguro de saúde por nível de instrução:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">byeduc &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="kw">svyby</span>( <span class="op">~</span><span class="st"> </span><span class="kw">as.numeric</span>( i001 <span class="op">==</span><span class="st"> </span><span class="dv">1</span> ) , <span class="op">~</span><span class="st"> </span>educ ,
<span class="dt">design =</span> pes_all_des_pos , <span class="dt">vartype =</span> <span class="st">&quot;ci&quot;</span> ,  <span class="dt">level =</span> <span class="fl">0.95</span> ,
svymean , <span class="dt">na.rm =</span> <span class="ot">TRUE</span> ) )
byeduc &lt;-<span class="st"> </span>byeduc[,<span class="op">-</span><span class="dv">1</span>]
<span class="kw">names</span>(byeduc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Prop&quot;</span>, <span class="st">&quot;l.i.c.&quot;</span>, <span class="st">&quot;l.s.c.&quot;</span>)</code></pre></div>
<p>Imprime tabela:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">kable</span>(byeduc,<span class="dt">booktabs =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">format =</span> <span class="st">&quot;latex&quot;</span>, 
<span class="dt">digits=</span> <span class="dv">3</span>, <span class="dt">caption =</span> <span class="st">&quot;Proporção de pessoas com seguro de saúde por nível </span>
<span class="st">de instrução&quot;</span>)</code></pre></div>

<p>Gráfico de barras usando a library <code>ggplot2</code> <span class="citation">(Wickham and Chang <a href="#ref-R-ggplot2">2016</a>)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(
    byeduc,
    <span class="kw">aes</span>( <span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;SinstFundi&quot;</span>, <span class="st">&quot;FundcMedi&quot;</span>, <span class="st">&quot;MedcSupi&quot;</span>, <span class="st">&quot;Supc&quot;</span>) , <span class="dt">y =</span> <span class="dv">100</span><span class="op">*</span>Prop )
    ) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>( <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span> ) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_errorbar</span>( <span class="kw">aes</span>( <span class="dt">ymin =</span> <span class="dv">100</span><span class="op">*</span>l.i.c. , <span class="dt">ymax =</span> <span class="dv">100</span><span class="op">*</span>l.s.c. ))  <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>( <span class="st">&quot;nível de instrução&quot;</span> ) <span class="op">+</span>
<span class="st">    </span><span class="kw">ylab</span>( <span class="st">&quot;% com seguro de saúde&quot; )+</span>
<span class="st">  ggtitle(&quot;</span>% de pessoas com plano de saúde, com indicação do intervalo de
  confiança de <span class="dv">95</span>%, segundo grupos de nível de instrução <span class="op">-</span><span class="st"> </span>Brasil <span class="op">-</span><span class="st"> </span><span class="dv">2013</span><span class="st">&quot;)</span></code></pre></div>
<p><img src="01-Cap1_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>

</div>
</div>
</div>
<h3>Referências</h3>
<div id="refs" class="references">
<div id="ref-albieri">
<p>Albieri, S., and Z. M. Bianchini. 1997. “Aspectos de Amostragem Relativos à Pesquisa Domiciliar Sobre Padrões de Vida.” Rio de Janeiro: IBGE, Departamento de Metodologia.</p>
</div>
<div id="ref-R-survey">
<p>Lumley, Thomas. 2017. <em>Survey: Analysis of Complex Survey Samples</em>. <a href="https://CRAN.R-project.org/package=survey" class="uri">https://CRAN.R-project.org/package=survey</a>.</p>
</div>
<div id="ref-kalton83a">
<p>Kalton, G. 1983a. “Compensating for Missing Survey Data.” Ann Arbor, Michigan: The University of Michigan, Institute for Social Research, Survey Research Center.</p>
</div>
<div id="ref-LR2002">
<p>Little, R. J. A., and D. B. Rubin. 2002. <em>Statistical Analysis with Missing Data</em>. Nova Iorque: John Wiley; Sons.</p>
</div>
<div id="ref-Rubin87">
<p>Rubin, D. 1987. <em>Multiple Imputation for Nonresponse in Surveys</em>. Nova Iorque: John Wiley; Sons.</p>
</div>
<div id="ref-SSW92">
<p>Särndal, C-E., B. Swensson, and J. H. Wretman. 1992. <em>Model Assisted Survey Sampling</em>. Nova Iorque: Springer-Verlag.</p>
</div>
<div id="ref-Silva">
<p>Nascimento Silva, P. L. D. 1996. “Utilizing Auxiliary Information for Estimation and Analysis in Sample Surveys.” PhD thesis, University of Southampton, Department of Social Statistics.</p>
</div>
<div id="ref-SHS89">
<p>Skinner, C. J., D. Holt, and T. M. F. Smith, eds. 1989. <em>Analysis of Complex Surveys</em>. Chichester: John Wiley; Sons.</p>
</div>
<div id="ref-CHSK2003">
<p>Chambers, R.L., and C.J. Skinner, eds. 2003. <em>Analysis of Survey Data</em>. Chichester: John Wiley.</p>
</div>
<div id="ref-W85">
<p>Wolter, K. M. 1985. <em>Introduction to Variance Estimation</em>. Nova Iorque: Springer-Verlag.</p>
</div>
<div id="ref-cochran">
<p>Cochran, W. G. 1977. <em>Sampling Techniques</em>. Nova Iorque: John Wiley.</p>
</div>
<div id="ref-lethonen">
<p>Lehtonen, R., and E. J. Pahkinen. 1995. <em>Practical Methods for Design and Analysis of Complex Surveys</em>. Chichester: John Wiley; Sons.</p>
</div>
<div id="ref-Pfeff">
<p>Pfeffermann, D. 1993. “The Role of Sampling Weights When Modelling Survey Data.” <em>International Statistical Review</em> 61: 317–37.</p>
</div>
<div id="ref-binder83">
<p>Binder, D. A. 1983. “On the Variances of Asymptotically Normal Estimators from Complex Surveys.” <em>International Statistical Review</em> 51: 279–92.</p>
</div>
<div id="ref-Pessoa">
<p>Pessoa, D. G. C., P. L. D. Nascimento Silva, and R. P. N. Duarte. 1997. “Análise Estatística de Dados de Pesquisas Por Amostragem: Problemas No Uso de Pacotes Padrões.” <em>Revista Brasileira de Estatística</em> 33: 44–57.</p>
</div>
<div id="ref-PKR">
<p>Pfeffermann, D., A. M. Krieger, and Y. Rinott. 1998. “Parametric Distributions of Complex Survey Data Under Informative Probability Survey.” <em>Statistica Sinica</em> 8: 1087–1114.</p>
</div>
<div id="ref-bryk">
<p>Bryk, A. S., and S. W. Raudenbush. 1992. <em>Hierarquical Linear Models: Applications and Data Analysis Methods</em>. Newbury Park: Sage.</p>
</div>
<div id="ref-R-lodown">
<p>Damico, Anthony Joseph. 2016. <em>Lodown: Locally Download and Prepare Publicly-Available Microdata</em>. <a href="http://asdfree.com/" class="uri">http://asdfree.com/</a>.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, and Winston Chang. 2016. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2" class="uri">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="refinf.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["bookdown-adac.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
